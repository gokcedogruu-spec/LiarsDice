<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ö–æ—Å—Ç—è—à–∫–∏</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Shantell+Sans:wght@300..800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css?v=15">
</head>
<body class="bg_default">
    <div id="app">
        
                <!-- 1. LOADING -->
        <div id="screen-loading" class="screen center-content active" style="background: #2b2d42;">
            <img src="https://raw.githubusercontent.com/gokcedogruu-spec/LiarsDice/main/logo/applogo.png" class="game-logo float-anim" style="max-width: 200px;">
            
            <div class="loading-box" style="margin-top: 30px; width: 80%; max-width: 300px; text-align: center;">
                <div class="xp-track" style="height: 10px; background: rgba(255,255,255,0.1); margin-bottom: 10px;">
                    <div id="preload-bar" class="xp-fill" style="width: 0%; background: #06d6a0;"></div>
                </div>
                <div id="preload-text" style="color: #8d99ae; font-size: 0.8rem; font-weight: bold;">–ó–ê–ì–†–£–ó–ö–ê...</div>
                
                <button id="btn-start-app" class="btn btn-green hidden" style="margin-top: 20px; font-size: 1.2rem;">–ò–ì–†–ê–¢–¨</button>
            </div>
        </div>

        <!-- 2. HOME -->
        <div id="screen-home" class="screen center-content">
            <button class="btn-icon btn-rules" onclick="openRules()">?</button>
            <button class="btn-icon btn-encyclopedia" onclick="openEncyclopedia()">üìñ</button>
            <button id="btn-friends-menu" class="btn-icon btn-friends" onclick="openFriends()">üë•</button>
            <button class="btn-icon btn-leaderboard" onclick="openLeaderboard()">üèÜ</button>

            <img src="https://raw.githubusercontent.com/gokcedogruu-spec/LiarsDice/main/logo/applogo.png" class="game-logo float-anim" alt="Logo">
            
            <div class="profile-card pop-in clickable-card" onclick="requestMyStats()">
                <div class="rank-icon-box">
                    <img id="rank-badge-img" src="" alt="Rank" class="rank-img">
                </div>
                <h2 id="user-display">...</h2>
                <div class="rank-label" id="rank-display">...</div>
                <div class="coins-row">üí∞ <span id="user-coins">0</span></div>
                <div id="win-streak" class="streak-label">–°–µ—Ä–∏—è: 0 üî•</div>
                
                <div class="xp-track">
                    <div class="xp-bar"><div id="xp-fill" class="xp-fill"></div></div>
                    <span id="xp-text" class="xp-text">...</span>
                </div>
            </div>

            <div class="menu-buttons slide-up-delay">
                <button id="btn-to-create" class="btn btn-orange pulse-btn">–°–û–ó–î–ê–¢–¨ –ò–ì–†–£</button>
                <button id="btn-to-pve" class="btn btn-red">–ò–ì–†–ê–¢–¨ –° –ë–û–¢–û–ú</button>
                <button id="btn-join-room" class="btn btn-blue">–ü–†–ò–°–û–ï–î–ò–ù–ò–¢–¨–°–Ø</button>
                <button id="btn-to-cabin" class="btn btn-purple" style="display:none; margin-top: 8px;">–ö–ê–Æ–¢–ê</button>
                <button id="btn-shop" class="btn btn-green" style="margin-top: 8px;">–õ–ê–í–ö–ê</button>
            </div>
        </div>

        <!-- 3. SHOP -->
        <div id="screen-shop" class="screen center-content">
            <h2 class="title-text">–õ–ê–í–ö–ê</h2>
            <div class="shop-balance">üí∞ <span id="shop-coins">0</span></div>
            <div class="shop-tabs">
                <button id="tab-skins" class="tab-btn active" onclick="filterShop('skins')">–ö–æ—Å—Ç–∏</button>
                <button id="tab-frames" class="tab-btn" onclick="filterShop('frames')">–†–∞–º–∫–∏</button>
                <button id="tab-bg" class="tab-btn" onclick="filterShop('bg')">–ü–∞–ª—É–±–∞</button>
            </div>
            <div class="shop-grid" id="shop-items"></div>
            <button id="btn-shop-back" class="btn btn-gray" style="margin-top: 20px;">–ù–ê–ó–ê–î</button>
        </div>

        <!-- CABIN SCREEN -->
        <div id="screen-cabin" class="screen center-content">
            <h2 class="title-text" style="color: #9d4edd;">–ö–ê–Æ–¢–ê</h2>
            <div class="shop-balance">üí∞ <span id="cabin-coins">0</span></div>
            <div class="shop-grid" id="cabin-items"></div>
            <button id="btn-cabin-back" class="btn btn-gray" style="margin-top: 20px;">–ù–ê–ó–ê–î</button>
        </div>

        <!-- 4. PVE SETTINGS -->
        <div id="screen-pve-settings" class="screen center-content">
            <h2 class="subtitle">–ë–ò–¢–í–ê –° –ë–û–¢–û–ú</h2>
            <div class="card slide-up">
                <div class="setting-group">
                    <label>–°–ª–æ–∂–Ω–æ—Å—Ç—å:</label>
                     <div class="time-selector">
                        <!-- –£–ë–†–ê–õ–ò EASY, –î–û–ë–ê–í–ò–õ–ò LEGEND -->
                        <button class="btn-time active" onclick="setDiff('medium')">–°–†–ï–î–ù–ï</button>
                        <button class="btn-time" onclick="setDiff('pirate')">–ü–ò–†–ê–¢</button>
                        <button class="btn-time" style="color:#ffb703; border:1px solid #ffb703;" onclick="setDiff('legend')">–õ–ï–ì–ï–ù–î–ê</button>
                    </div>
                    <div id="diff-desc" style="text-align:center; font-size:0.8rem; margin-top:5px; opacity:0.7; font-weight:bold;">–ë–µ–∑ –Ω–∞–≥—Ä–∞–¥</div>
                </div>
                
                <div class="setting-group">
                    <label>–ö—É–±–∏–∫–æ–≤</label>
                    <div class="stepper-row">
                        <button class="btn-mini" onclick="adjSetting('dice', -1)">-</button>
                        <span id="pve-dice" class="stepper-val">5</span>
                        <button class="btn-mini" onclick="adjSetting('dice', 1)">+</button>
                    </div>
                </div>
                <div class="setting-group">
                    <label>–ë–æ—Ç–æ–≤</label>
                    <div class="stepper-row">
                        <button class="btn-mini" onclick="adjSetting('bots', -1)">-</button>
                        <span id="pve-bots" class="stepper-val">3</span>
                        <button class="btn-mini" onclick="adjSetting('bots', 1)">+</button>
                    </div>
                </div>

                <div class="setting-group" style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button id="btn-rule-jokers-pve" class="btn-time" onclick="toggleRule('jokers', true)">üÉè –î–∂–æ–∫–µ—Ä—ã</button>
                    <button id="btn-rule-spot-pve" class="btn-time" onclick="toggleRule('spot', true)">üéØ –í —Ç–æ—á–∫—É</button>
                    <button id="btn-rule-strict-pve" class="btn-time" onclick="toggleRule('strict', true)">üîí –°—Ç—Ä–æ–≥–æ</button>
                </div>

                <button id="btn-start-pve" class="btn btn-red" style="margin-top: 20px;">–í –ë–û–ô!</button>
                <button id="btn-pve-back" class="btn btn-gray">–ù–ê–ó–ê–î</button>
            </div>
        </div>

        <!-- 5. MULTIPLAYER SETTINGS -->
        <div id="screen-create-settings" class="screen center-content">
            <h2 class="subtitle">–ù–ê–°–¢–†–û–ô–ö–ò</h2>
            <div class="card slide-up">
                <div class="setting-group">
                    <label>–ö—É–±–∏–∫–æ–≤</label>
                    <div class="stepper-row">
                        <button class="btn-mini" onclick="adjSetting('dice', -1)">-</button>
                        <span id="set-dice" class="stepper-val">5</span>
                        <button class="btn-mini" onclick="adjSetting('dice', 1)">+</button>
                    </div>
                </div>
                <div class="setting-group">
                    <label>–ò–≥—Ä–æ–∫–æ–≤</label>
                    <div class="stepper-row">
                        <button class="btn-mini" onclick="adjSetting('players', -1)">-</button>
                        <span id="set-players" class="val-text">10</span>
                        <button class="btn-mini" onclick="adjSetting('players', 1)">+</button>
                    </div>
                </div>
                <div class="setting-group">
                    <label>–í—Ä–µ–º—è –Ω–∞ —Ö–æ–¥</label>
                    <div class="time-selector">
                        <button class="btn-time active" onclick="setTime(30)">30—Å</button>
                        <button class="btn-time" onclick="setTime(45)">45—Å</button>
                        <button class="btn-time" onclick="setTime(60)">60—Å</button>
                    </div>
                </div>

                <!-- FIX: ADDED RULES BUTTONS HERE -->
                <div class="setting-group" style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button id="btn-rule-jokers" class="btn-time" onclick="toggleRule('jokers')">üÉè –î–∂–æ–∫–µ—Ä—ã</button>
                    <button id="btn-rule-spot" class="btn-time" onclick="toggleRule('spot')">üéØ –í —Ç–æ—á–∫—É</button>
                    <button id="btn-rule-strict" class="btn-time" onclick="toggleRule('strict')">üîí –°—Ç—Ä–æ–≥–æ</button>
                </div>

                <div class="setting-group" style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 10px;">
                    <label>–°–¢–ê–í–ö–ò</label>
                    <div class="bet-selector">
                        <div class="bet-label">üí∞ –ü–µ—Å–æ: <span id="val-bet-coins" style="color:gold">0</span></div>
                        <input type="range" id="range-bet-coins" min="0" max="9" step="1" value="0" oninput="updateBetVal('coins')">
                    </div>
                    <div class="bet-selector">
                        <div class="bet-label">‚≠ê –ì–æ–¥—ã: <span id="val-bet-xp" style="color:cyan">0</span></div>
                        <input type="range" id="range-bet-xp" min="0" max="4" step="1" value="0" oninput="updateBetVal('xp')">
                    </div>
                </div>

                <button id="btn-confirm-create" class="btn btn-green" style="margin-top: 20px;">–°–û–ó–î–ê–¢–¨</button>
                <button id="btn-back-home" class="btn btn-gray">–ù–ê–ó–ê–î</button>
            </div>
        </div>

        <!-- 6. LOBBY -->
        <div id="screen-lobby" class="screen">
            <div class="header slide-down">
                <div class="room-code-card" id="share-btn">
                    <div class="code-label">–ö–û–î –ö–û–ú–ù–ê–¢–´</div>
                    <div class="code-val" id="lobby-room-id">...</div>
                    <div class="code-hint">–ù–∞–∂–º–∏, —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</div>
                </div>
                <div class="rules-tag" id="lobby-rules">...</div>
                <div class="bets-tag" id="lobby-bets"></div>
            </div>
            <div class="card flex-grow slide-up">
                <h3 class="card-header">–ö–û–ú–ê–ù–î–ê</h3>
                <div id="lobby-players" class="player-list-scroll"></div>
            </div>
            <div class="bottom-controls pop-in">
                <div class="lobby-btns-row">
                    <button class="btn btn-red" onclick="leaveLobby()" style="flex: 1;">–ù–ê–ó–ê–î</button>
                    <button class="btn btn-purple" onclick="openInviteModal()" style="flex: 1;">–î–†–£–ó–¨–Ø</button>
                    <button id="btn-ready" class="btn btn-blue" style="flex: 2;">–Ø –ì–û–¢–û–í</button>
                </div>
                 <button id="btn-share-native" class="btn btn-orange" style="margin-top:10px;">–ü–†–ò–ì–õ–ê–°–ò–¢–¨ –í –ö–û–ú–ù–ê–¢–£</button>
                <button id="btn-start-game" class="btn btn-green" style="display:none; margin-top:10px;">–ü–û–ì–ù–ê–õ–ò!</button>
            </div>
        </div>

        <!-- 7. GAME (REDESIGNED) -->
        <div id="screen-game" class="screen game-layout">
            <!-- –≠—Ñ—Ñ–µ–∫—Ç—ã -->
            <div id="red-flash-overlay" class="red-flash-overlay"></div>
            <div id="bluff-cloud" class="bluff-cloud hidden">–ù–ï –í–ï–†–Æ!</div>

            <button class="btn-mini btn-game-leave" onclick="leaveGame()">‚úï</button>

            <div class="rivals-bar-container">
                <div id="players-bar" class="rivals-row"></div>
            </div>
            <div class="table-center">
                <!-- 1. –¢–ï–ö–°–¢ –°–¢–ê–í–ö–ò (–¢–ï–ü–ï–†–¨ –°–í–ï–†–•–£) -->
                <div id="game-log" class="game-log-box-large"></div>
                
                <div id="active-rules-display" style="margin-bottom: 5px; font-size: 0.8rem; opacity: 0.7; font-weight: bold; text-shadow: 1px 1px 0 black;"></div>

                <!-- 2. –ü–£–ó–´–†–¨ –°–¢–ê–í–ö–ò -->
                <div class="bid-bubble pop-in" id="current-bid-display">...</div>
                
                <!-- 3. –¢–ê–ô–ú–ï–† (–¢–ï–ü–ï–†–¨ –°–ù–ò–ó–£) -->
                <div class="timer-capsule" style="margin-top: 15px; margin-bottom: 5px;">
                    <span class="timer-icon">‚è≥</span>
                    <div class="timer-track"><div class="timer-progress"></div></div>
                </div>
            </div>
            
            <div class="my-controls-area slide-up">
                <!-- –ù–û–í–ê–Ø –ö–ù–û–ü–ö–ê –≠–ú–û–î–ó–ò (–°–õ–ï–í–ê –ò–õ–ò –°–ü–†–ê–í–ê –û–¢ –ö–£–ë–ò–ö–û–í) -->
                <div style="position: relative; margin-bottom: 10px; display: flex; justify-content: center;">
                    <button class="btn-emoji-toggle" onclick="toggleEmojiPanel()"><img src="https://raw.githubusercontent.com/gokcedogruu-spec/LiarsDice/main/emotions/default_laugh.png" style="width: 100%; height: 100%; object-fit: contain;"></button>
                    
                    <!-- –ü–ê–ù–ï–õ–¨ –í–´–ë–û–†–ê –≠–ú–û–î–ó–ò (–°–ö–†–´–¢–ê –ü–û –£–ú–û–õ–ß–ê–ù–ò–Æ) -->
                    <div id="emoji-panel" class="emoji-panel hidden">
                        <!-- –°–Æ–î–ê –î–û–ë–ê–í–õ–Ø–¢–¨ –ù–û–í–´–ï –≠–ú–û–î–ó–ò -->
                        <div class="emoji-grid">
                            <img src="https://raw.githubusercontent.com/gokcedogruu-spec/LiarsDice/main/emotions/default_dead.png" onclick="sendEmoteAndClose('dead')">
                            <img src="https://raw.githubusercontent.com/gokcedogruu-spec/LiarsDice/main/emotions/default_angry.png" onclick="sendEmoteAndClose('angry')">
                            <img src="https://raw.githubusercontent.com/gokcedogruu-spec/LiarsDice/main/emotions/default_skeptic.png" onclick="sendEmoteAndClose('skeptic')">
                            <img src="https://raw.githubusercontent.com/gokcedogruu-spec/LiarsDice/main/emotions/default_panic.png" onclick="sendEmoteAndClose('panic')">
                            <img src="https://raw.githubusercontent.com/gokcedogruu-spec/LiarsDice/main/emotions/default_bully.png" onclick="sendEmoteAndClose('bully')">
                            <img src="https://raw.githubusercontent.com/gokcedogruu-spec/LiarsDice/main/emotions/default_button.png" onclick="sendEmoteAndClose('button')">
                            <img src="https://raw.githubusercontent.com/gokcedogruu-spec/LiarsDice/main/emotions/default_nirvana.png" onclick="sendEmoteAndClose('nirvana')">
                            <img src="https://raw.githubusercontent.com/gokcedogruu-spec/LiarsDice/main/emotions/default_laugh.png" onclick="sendEmoteAndClose('laugh')">
                            <img src="https://raw.githubusercontent.com/gokcedogruu-spec/LiarsDice/main/emotions/default_kiss.png" onclick="sendEmoteAndClose('kiss')">
                            <img src="https://raw.githubusercontent.com/gokcedogruu-spec/LiarsDice/main/emotions/default_tongue.png" onclick="sendEmoteAndClose('tongue')">
                            <img src="https://raw.githubusercontent.com/gokcedogruu-spec/LiarsDice/main/emotions/default_sad.png" onclick="sendEmoteAndClose('sad')">
                            <img src="https://raw.githubusercontent.com/gokcedogruu-spec/LiarsDice/main/emotions/default_gigachad.png" onclick="sendEmoteAndClose('gigachad')">
                        </div>
                    </div>
                </div>

                <div class="my-dice-panel">
                    <div class="panel-label">–ú–û–ò –ö–û–°–¢–ò</div>
                    <div id="my-dice" class="my-dice-row"></div>
                </div>
                <div id="game-controls" class="action-panel hidden">
                    <div class="bid-controls">
                        <div class="bid-stepper">
                            <label>–ö–û–õ-–í–û</label>
                            <div class="stepper-row">
                                <button class="btn-mini" onclick="adjBid('qty', -1)">-</button>
                                <span id="display-qty" class="bid-val">1</span>
                                <button class="btn-mini" onclick="adjBid('qty', 1)">+</button>
                            </div>
                        </div>
                        <div class="bid-stepper">
                            <label>–ß–ò–°–õ–û</label>
                            <div class="stepper-row">
                                <button class="btn-mini" onclick="adjBid('val', -1)">-</button>
                                <span id="display-val" class="dice-face">2</span>
                                <button class="btn-mini" onclick="adjBid('val', 1)">+</button>
                            </div>
                        </div>
                    </div>
                    <div class="main-actions">
                        <button id="btn-make-bid" class="btn btn-orange">–°–¢–ê–í–ö–ê</button>
                        <button id="btn-call-bluff" class="btn btn-red">–ù–ï –í–ï–†–Æ!</button>
                        <button id="btn-call-spot" class="btn btn-blue hidden-rule">–í –¢–û–ß–ö–£</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 8. RESULT -->
        <div id="screen-result" class="screen center-content">
            <div class="pop-in">
                <h1 class="title-text">–ò–ì–†–ê –û–ö–û–ù–ß–ï–ù–ê</h1>
                <div class="card winner-box">
                    <div class="trophy-icon">üèÜ</div>
                    <h2 id="winner-name" class="winner-name">...</h2>
                    <p class="winner-sub">–ü–æ–±–µ–¥–∏—Ç–µ–ª—å</p>
                    <div id="result-profit" style="margin-top:10px; font-weight:bold; font-size:1rem;"></div>
                </div>
            </div>
            <div class="slide-up-delay">
                <button id="btn-restart" class="btn btn-green">–ï–©–ï –†–ê–ó</button>
                <button id="btn-home" class="btn btn-blue">–í –ú–ï–ù–Æ</button>
            </div>
        </div>

        <!-- 9. PLAYER INFO MODAL -->
        <div id="modal-player" class="modal-overlay" onclick="closePlayerModal(event)">
            <div class="modal-content pop-in">
                <button class="btn-close" onclick="closePlayerModal(null)">‚úï</button>
                
                <div class="modal-header">
                    <div class="rank-icon-box small">
                        <img id="info-rank-img" src="" alt="Rank" class="rank-img">
                    </div>
                    <h2 id="info-name">–ò–º—è –ò–≥—Ä–æ–∫–∞</h2>
                    <div id="info-rank-name" class="rank-label">–†–∞–Ω–≥</div>
                </div>
                
                <div class="stats-row">
                    <div class="stat-box">
                        <div class="stat-val" id="info-matches">0</div>
                        <div class="stat-label">–ò–≥—Ä</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-val" id="info-wins">0</div>
                        <div class="stat-label">–ü–æ–±–µ–¥</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-val" id="info-wr">0%</div>
                        <div class="stat-label">–í–∏–Ω—Ä–µ–π—Ç</div>
                    </div>
                </div>

                <h3 class="modal-subtitle">–ö–æ–ª–ª–µ–∫—Ü–∏—è</h3>
                <div id="info-inventory" class="inventory-grid-mini"></div>
                <button id="btn-add-friend" class="btn-add-friend-game" style="display:none;" onclick="sendFriendRequestFromGame()">–î–û–ë–ê–í–ò–¢–¨ –í –î–†–£–ó–¨–Ø</button>
            </div>
        </div>

        <!-- 10. RULES MODAL -->
        <div id="modal-rules" class="modal-overlay" onclick="closeRules(event)">
            <div class="modal-content pop-in scrollable-content">
                <button class="btn-close" onclick="closeRules(null)">‚úï</button>
                <h2 class="modal-title">–ö–æ–¥–µ–∫—Å –ü–∏—Ä–∞—Ç–∞</h2>
                
                <div class="rules-section">
                    <h3>üé≤ –ë–∞–∑–∞</h3>
                    <p>–£–≥–∞–¥–∞–π, —Å–∫–æ–ª—å–∫–æ –∫–æ—Å—Ç–µ–π –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –Ω–æ–º–∏–Ω–∞–ª–∞ (–∏–ª–∏ –±–æ–ª—å—à–µ) –Ω–∞ —Å—Ç–æ–ª–µ. –°—Ç–∞–≤–∫–∞ <b>"3x[4]"</b> –∑–Ω–∞—á–∏—Ç: "–Ø –¥—É–º–∞—é, —Ç—É—Ç –º–∏–Ω–∏–º—É–º —Ç—Ä–∏ —á–µ—Ç–≤–µ—Ä–∫–∏".</p>
                    <p>–°–ª–µ–¥—É—é—â–∏–π –¥–æ–ª–∂–µ–Ω –ø–æ–≤—ã—Å–∏—Ç—å —Å—Ç–∞–≤–∫—É (–∫–æ–ª-–≤–æ –∏–ª–∏ –Ω–æ–º–∏–Ω–∞–ª) –∏–ª–∏ —Å–∫–∞–∑–∞—Ç—å <b>"–ù–ï –í–ï–†–Æ!"</b>.</p>
                    <p>–ï—Å–ª–∏ –Ω–µ –ø–æ–≤–µ—Ä–∏–ª –∏ –æ–∫–∞–∑–∞–ª—Å—è –ø—Ä–∞–≤ ‚Äî –ª–∂–µ—Ü —Ç–µ—Ä—è–µ—Ç –∫—É–±. –ï—Å–ª–∏ –∫—É–±—ã –±—ã–ª–∏ ‚Äî —Ç–µ—Ä—è–µ—à—å —Ç—ã.</p>
                </div>

                <div class="rules-section">
                    <h3>üí∞ –°—Ç–∞–≤–∫–∏</h3>
                    <p>–í —Ä–µ–∂–∏–º–µ PVP –º–æ–∂–Ω–æ —Å—Ç–∞–≤–∏—Ç—å <b>–ü–µ—Å–æ</b> –∏ <b>–ì–æ–¥—ã —Å–ª—É–∂–±—ã</b>.</p>
                    <p>–ü—Ä–æ–∏–≥—Ä–∞–≤—à–∏–µ —Ç–µ—Ä—è—é—Ç —Å—Ç–∞–≤–∫—É. –ü–æ–±–µ–¥–∏—Ç–µ–ª—å –∑–∞–±–∏—Ä–∞–µ—Ç <b>–í–°–ï</b> —Å—Ç–∞–≤–∫–∏ —Å–æ —Å—Ç–æ–ª–∞.</p>
                </div>

                <div class="rules-section">
                    <h3>‚öîÔ∏è –†–µ–∂–∏–º—ã</h3>
                    <p><b>üÉè –î–∂–æ–∫–µ—Ä—ã:</b> –ï–¥–∏–Ω–∏—Ü—ã (1) —Å—á–∏—Ç–∞—é—Ç—Å—è –∑–∞ –ª—é–±–æ–π –Ω–æ–º–∏–Ω–∞–ª.</p>
                    <p><b>üîí –°—Ç—Ä–æ–≥–æ:</b> –ü–æ–≤—ã—à–∞—Ç—å –º–æ–∂–Ω–æ –¢–û–õ–¨–ö–û –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—É–±–æ–≤.</p>
                    <p><b>üéØ –í —Ç–æ—á–∫—É:</b> –ú–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å "–í —Ç–æ—á–∫—É". –ï—Å–ª–∏ —É–≥–∞–¥–∞–ª —Ç–æ—á–Ω–æ–µ —á–∏—Å–ª–æ –∫—É–±–æ–≤ ‚Äî –∂–µ—Ä—Ç–≤–∞ —Ç–µ—Ä—è–µ—Ç –∫—É–±. –û—à–∏–±—Å—è ‚Äî —Ç–µ—Ä—è–µ—à—å —Ç—ã.</p>
                </div>

                <div class="rules-section">
                    <h3>‚öì –ù–∞–≤—ã–∫–∏ (1 —Ä–∞–∑ –∑–∞ –∏–≥—Ä—É)</h3>
                    <p><b>üëÇ –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ —É—à–∏ (–ë–æ—Ü–º–∞–Ω+):</b> –®–∞–Ω—Å —É–∑–Ω–∞—Ç—å, –≤—Ä–µ—Ç –ª–∏ –∏–≥—Ä–æ–∫ –ø–µ—Ä–µ–¥ —Ç–æ–±–æ–π.</p>
                    <p><b>üé≤ –°—á–∞—Å—Ç–ª–∏–≤—ã–π –∫—É–±–∏–∫ (–ü–æ–º–æ—â–Ω–∏–∫+):</b> –®–∞–Ω—Å –ø–æ–ª—É—á–∏—Ç—å –∏–ª–∏ –ø–æ—Ç–µ—Ä—è—Ç—å 1 –∫—É–±–∏–∫ (–µ—Å–ª–∏ –∏—Ö < 5).</p>
                    <p><b>üíÄ –í–æ–∑–º–µ–∑–¥–∏–µ (–ö–∞–ø–∏—Ç–∞–Ω+):</b> –í –¥—É—ç–ª–∏ 1 –Ω–∞ 1 (–ø–æ 1 –∫—É–±—É) —à–∞–Ω—Å –ø—Ä–∏—Å—Ç—Ä–µ–ª–∏—Ç—å –≤—Ä–∞–≥–∞ –∏ –ø–æ–±–µ–¥–∏—Ç—å.</p>
                </div>

                <div class="rules-footer">
                    by ZMSS Games. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.
                </div>
            </div>
        </div>

        <!-- 11. ENCYCLOPEDIA MODAL -->
        <div id="modal-encyclopedia" class="modal-overlay" onclick="closeEncyclopedia(event)">
            <div class="modal-content pop-in scrollable-content">
                <button class="btn-close" onclick="closeEncyclopedia(null)">‚úï</button>
                <h2 class="modal-title">–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è</h2>
                <div id="encyclopedia-content"></div>
            </div>
        </div>

        <!-- 12. SKILL ALERT -->
        <div id="modal-skill-alert" class="modal-overlay" onclick="closeSkillAlert()">
            <div class="modal-content pop-in" style="max-width: 280px; padding-top:40px;">
                <div class="skill-alert-icon" id="skill-alert-title"></div>
                <h2 class="modal-title" style="font-size:1.4rem; margin-bottom:10px;">–ù–ê–í–´–ö</h2>
                <p id="skill-alert-text" style="font-size:1.1rem; font-weight:bold; color:white; margin-bottom:20px;"></p>
                <button class="btn btn-blue" onclick="closeSkillAlert()">–ü–û–ù–Ø–õ</button>
            </div>
        </div>

        <!-- 13. RESOURCE ALERT -->
        <div id="modal-res-alert" class="modal-overlay" onclick="closeResAlert()">
            <div class="modal-content pop-in" style="max-width: 280px; padding-top:20px;">
                <div style="font-size:3rem; margin-bottom:10px;">üö´</div>
                <h2 class="modal-title" style="font-size:1.4rem; margin-bottom:10px; color:#ef233c;">–ù–ò–©–ï–¢–ê</h2>
                <p id="res-alert-text" style="font-size:1rem; color:white; margin-bottom:20px;">–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è —Å—Ç–∞–≤–∫–∏!</p>
                <button class="btn btn-red" onclick="closeResAlert()">–ù–ê–ó–ê–î</button>
            </div>
        </div>

        <!-- 14. SYSTEM MODAL -->
        <div id="modal-system" class="modal-overlay">
            <div class="modal-content pop-in" style="max-width: 320px;">
                <h2 id="sys-title" class="modal-title" style="font-size: 1.4rem; margin-bottom: 10px;">–í–Ω–∏–º–∞–Ω–∏–µ</h2>
                <p id="sys-text" style="font-size: 1.1rem; color: white; margin-bottom: 20px; font-weight: bold; line-height: 1.4;"></p>
                <input type="text" id="sys-input" class="hidden" maxlength="10" style="margin-bottom: 20px; text-transform: uppercase;">
                <div id="sys-btns" class="lobby-btns-row" style="justify-content: center; gap: 10px;"></div>
            </div>
        </div>

        <!-- 15. FRIENDS MODAL -->
        <div id="modal-friends" class="modal-overlay" onclick="closeFriends(event)">
            <div class="modal-content pop-in" style="height: 80%; max-height: 600px; display:flex; flex-direction:column;">
                <button class="btn-close" onclick="closeFriends(null)">‚úï</button>
                <h2 class="modal-title">–ö–û–ú–ê–ù–î–ê</h2>
                <div class="friend-tabs">
                    <button id="tab-f-list" class="friend-tab active" onclick="switchFriendTab('list')">–°–í–û–ò</button>
                    <button id="tab-f-req" class="friend-tab" onclick="switchFriendTab('req')">–ó–ê–ü–†–û–°–´</button>
                    <button id="tab-f-find" class="friend-tab" onclick="switchFriendTab('find')">–ü–û–ò–°–ö</button>
                </div>
                <div id="friend-content-list" class="friend-list-container flex-grow">Loading...</div>
                <div id="friend-content-req" class="friend-list-container flex-grow hidden"></div>
                <div id="friend-content-find" class="friend-list-container flex-grow hidden">
                    <input type="text" id="input-friend-search" placeholder="–ò–º—è –ø–∏—Ä–∞—Ç–∞..." style="margin-bottom:10px;">
                    <button class="btn btn-blue" onclick="searchFriend()">–ò–°–ö–ê–¢–¨</button>
                    <div id="search-result"></div>
                </div>
            </div>
        </div>
        
        <!-- 16. LEADERBOARD MODAL -->
<div id="modal-leaderboard" class="modal-overlay" onclick="closeLeaderboard(event)">
    <div class="modal-content pop-in" style="height: 80%; max-height: 600px; display:flex; flex-direction:column;">
        <button class="btn-close" onclick="closeLeaderboard(null)">‚úï</button>
        <h2 class="modal-title" style="color:#ffb703;">–¢–û–ü 50</h2>
        
        <div class="leaderboard-header">
            <span>#</span>
            <span style="flex:1; text-align:left; padding-left:10px;">–ü–ò–†–ê–¢</span>
            <span>XP</span>
            <span>WIN</span>
        </div>

        <div id="leaderboard-list" class="friend-list-container flex-grow">Loading...</div>
    </div>
</div>

    </div>
    <script src="/socket.io/socket.io.js"></script>
    <script src="app.js?v=15"></script>
</body>
</html>






